general:
  backend: "a1111"
  a1111_endpoint: "http://127.0.0.1:7860"
  model_checkpoint: ""
  max_retries: 3
  retry_delay: 2
  timeout_seconds: 300

b_pass:
  prompt: "ultra sharp contouring, very strong cheekbone definition, precise cheek lines, crisp jawline and face oval, defined eyelashes, sharp eyeliner, volumized lashes, defined eyebrows, precise lip liner, rich lipstick, subtle blush, glossy skin highlights, dewy specular highlights on cheekbones and nose bridge, high-detail eyes, slight nose contour, cinematic portrait lighting, studio beauty photo"
  negative: "waxy skin, plastic look, smeared makeup, halo glow, blown highlights, color bleeding, blurry edges, soft focus, gaussian blur"
  denoise: 0.18
  cfg: 5.0
  steps: 32
  sampler: "DPM++ SDE Karras"
  mask_blur_px: 6

  # Run only one ADetailer pass chosen automatically (ad → ad2 → ad3) by quick pre-detection
  use_sequential_adetailer: true
  # True fallback: випробувати ad, якщо 0 детекцій → ad2, якщо 0 → ad3 (робить кілька послідовних викликів)
  use_true_fallback_adetailer: true

  # Manual fallback — якщо всі ADetailer не спрацювали
  enable_manual_fallback: true
  manual_mask_filename: "custom_face_mask.png"  # намалюйте/покладіть маску у work/<name>/masks/
  open_ui_on_manual: true  # відкрити UI за посиланням general.a1111_endpoint
  open_manual_help_on_manual: true  # відкрити локальні інструкції у браузері
  manual_help_path: "manual_fallback_help.html"  # шлях до локальної HTML-інструкції

  # Cheek Refiner (FaceMesh/BiSeNet)
  use_cheek_refiner: true
  cheek_mask_source: "facemesh"  # facemesh | manual
  cheek_denoise: 0.16
  cheek_mask_dilate: 10
  cheek_mask_blur: 12
  cheek_prompt: "hyper-realistic cheekbones, crisp cheek lines, glossy cheek highlights, subtle skin texture, cinematic beauty lighting"
  cheek_negative: "over-smoothing, waxy skin, plastic look, harsh edges, color bleeding"

  # Eyelash Refiner (FaceMesh/BiSeNet)
  use_eyelash_refiner: true
  eyelash_mask_source: "facemesh"  # facemesh | manual
  eyelash_denoise: 0.14
  eyelash_mask_dilate: 4
  eyelash_mask_blur: 6
  eyelash_prompt: "defined, separated eyelashes, crisp individual lashes, no clumping, subtle eyeliner, natural spacing, sharp detail"
  eyelash_negative: "clumpy lashes, spider lashes, smeared mascara, overly thick lashes, blurred eyelashes"

  # ControlNet 0 — SoftEdge SDXL (shape keeper)
  use_controlnet: true
  controlnet_module: "softedge_hed"
  controlnet_model: "controlnet-sd-xl-1.0-softedge-dexined.safetensors"
  controlnet_weight: 0.58
  controlnet_guidance_start: 0.00
  controlnet_guidance_end: 0.60
  controlnet_mode: 1

  # ControlNet 1 — Canny/Lineart from our contour_map.png
  use_controlnet2: true
  controlnet2_module: "canny"
  controlnet2_model: "controlnet-sd-xl-1.0-canny.safetensors"
  controlnet2_weight: 0.60
  controlnet2_guidance_start: 0.25
  controlnet2_guidance_end: 0.90
  controlnet2_mode: 2

  # ADetailer — face-only inpaint
  use_adetailer: true
  ad_model: "face_yolov8n.pt"
  ad_confidence: 0.33
  ad_mask_min_ratio: 0.01
  ad_dilate_erode: 16
  ad_mask_blur: 14
  ad_denoise: 0.16
  ad_prompt: "ultra sharp eyelashes, cat-eye razor eyeliner, detailed eyes, defined eyebrows, precise bold lip liner, glossy lips, cheekbone highlight, glossy nose bridge highlight"
  ad_negative: "smeared mascara, blurry eyelashes, feathered lip liner"

  # ADetailer 2 — optional second face pass
  use_adetailer2: true
  ad2_model: "face_yolov8n.pt"
  ad2_confidence: 0.25
  ad2_mask_min_ratio: 0.005
  ad2_dilate_erode: 16
  ad2_mask_blur: 14
  ad2_denoise: 0.16

  # ADetailer 3 — optional third pass for rotated/low-position faces (more permissive)
  use_adetailer3: true
  ad3_model: "face_yolov8n.pt"  # you can change to "face_yolov8l.pt" if available for stronger recall
  ad3_confidence: 0.15
  ad3_mask_min_ratio: 0.003
  ad3_dilate_erode: 20
  ad3_mask_blur: 18
  ad3_denoise: 0.18
  # ad3_prompt: ""
  # ad3_negative: ""

io:
  input_dir: "input"
  work_dir: "work"
  output_dir: "output"
  # Нові параметри
  supported_formats: ["png", "jpg", "jpeg", "webp"]
  backup_original: true
  create_thumbnails: false

# Нова секція для налаштування якості
quality:
  # Автоматичне тестування якості результатів
  enable_quality_check: true
  min_face_detection_confidence: 0.5
  max_blur_threshold: 100
  min_sharpness_score: 0.6
  
  # Налаштування для різних типів зображень
  portrait_mode:
    enhanced_cheekbones: true
    enhanced_eyes: true
    enhanced_lips: true
    skin_smoothing: 0.3
  
  group_mode:
    enhanced_cheekbones: false
    enhanced_eyes: true
    enhanced_lips: false
    skin_smoothing: 0.5

# Нова секція для логування
logging:
  level: "INFO"
  file_logging: true
  log_file: "adetailer_batch.log"
  max_log_size_mb: 10
  backup_count: 3
